<!DOCTYPE html><html lang="cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="robots" content="index, follow"><title>R 语言里常用的分布函数 • 商业与数据</title><meta name="description" content="R 语言里常用的分布函数 - Yu Qin"><link rel="icon" href="/blog/favicon.svg"><link rel="stylesheet" href="https://unpkg.com/nanoreset@3.0.1/nanoreset.min.css"><link rel="stylesheet" href="/blog/css/theme.css"><link rel="search" type="application/opensearchdescription+xml" href="/blog/atom.xml" title="商业与数据"><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/blog/atom.xml" title="商业与数据" type="application/atom+xml">
<!-- hexo-inject:begin --><!-- hexo-inject:end --></head><body><div class="wrap" id="barba-wrapper"><header><h1 class="branding"><a href="/blog/" title="商业与数据">商业与数据</a></h1><ul class="nav nav-list"><li class="nav-list-item"><a class="nav-list-link no-barba" href="/blog/" target="_self">HOME</a></li><li class="nav-list-item"><a class="nav-list-link no-barba" href="/blog/archives" target="_self">ARCHIVES</a></li><li class="nav-list-item"><a class="nav-list-link no-barba" href="https://github.com/YuPototo" target="_blank">GITHUB</a></li></ul></header><div class="barba-container"><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">R 语言里常用的分布函数</h1><div class="post-info"><a></a>2020-01-14</div><div class="post-content"><p>这篇博文小结 R 语言里涉及概率分布的几个函数。</p>
<!-- hexo-inject:begin --><!-- hexo-inject:end --><p>每个概率分布函数在 R 里都有4个对应的函数，分别以1个字母开头：</p>
<ul>
<li>d：表示 density，指概率密度函数 probability density function (pdf)</li>
<li>p：表示 probability，指累计分布函数 cumulative density function (cdf)</li>
<li>q: 表示 quantile，是 cdf 的逆函数</li>
<li>r：表示 random，符合该概率分布的随机数</li>
</ul>
<p>如果你像我一样已经不记得概率论的老师长啥样，上个的一些名词应该会让你一头雾水。没关系，我们接下来就用 R 代码一一测试。</p>
<p><a id="more"></a></p>
<h2 id="二项分布-Binomial-Distribution"><a href="#二项分布-Binomial-Distribution" class="headerlink" title="二项分布 Binomial Distribution"></a>二项分布 Binomial Distribution</h2><p>我们先以二项分布作为例子。二项分布是一个离散随机变量。</p>
<p>二项分布描述的问题是：每次试验有两个结果，成功或失败，n 次试验后成功 k 次的概率有多少？</p>
<p>R 语言里是 binom。</p>
<h3 id="dbinom"><a href="#dbinom" class="headerlink" title="dbinom"></a>dbinom</h3><p><code>dbinom(x, size, prob)</code> 就是计算概率的公式，其中：</p>
<ul>
<li>x：成功次数</li>
<li>size：总试验次数</li>
<li>prob：单次试验的成功概率</li>
</ul>
<p>比如，扔5次硬币，正面2次的概率可以计算为：</p>
<figure class="highlight r"><figcaption><span>R代码</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dbinom(<span class="number">2</span>, size=<span class="number">5</span>, prob=<span class="number">0.5</span>) </span><br></pre></td></tr></tbody></table></figure>

<p>结果：0.3125</p>
<h3 id="pbinom"><a href="#pbinom" class="headerlink" title="pbinom"></a>pbinom</h3><p><code>pbinom(q, size, prob)</code> 是计算累计概率的函数，其中 q 是 quantile。</p>
<p>例子：扔5次硬币，最多有1次正面的概率是对少？(即0次或1次)</p>
<figure class="highlight r"><figcaption><span>R代码</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pbinom(<span class="number">1</span>, size=<span class="number">5</span>, prob=<span class="number">0.5</span>) </span><br></pre></td></tr></tbody></table></figure>

<p>答案：0.1875。</p>
<p>我们可以用 <code>dbinom(0, 5, 0.5) + dbinom(1, 5, 0.5)</code> 来做验证</p>
<h3 id="qbinom"><a href="#qbinom" class="headerlink" title="qbinom"></a>qbinom</h3><p><code>qbinom</code> 是 <code>pbinom</code> 的逆函数。我可以计算累计概率为 p 的对应 quntile 是多少。</p>
<p>使用刚才的0.1875去计算：</p>
<figure class="highlight r"><figcaption><span>R代码</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">qbinom(<span class="number">0.1875</span>, size=<span class="number">5</span>, prob=<span class="number">0.5</span>) </span><br></pre></td></tr></tbody></table></figure>

<p>我们应该得到 1。</p>
<h3 id="rbinom"><a href="#rbinom" class="headerlink" title="rbinom"></a>rbinom</h3><p><code>rbinom(n, size, prob)</code> 给出 n 个符合二项分布的随机数。</p>
<p>我们刚才计算了扔5次硬币时，成功2次的概率是 0.3125。</p>
<p>现在我们分别生成100、1000和10000个随机数，看看 x = 2 的频率是不是接近这个数字。</p>
<figure class="highlight r"><figcaption><span>R代码</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">set.seed(<span class="number">123</span>)</span><br><span class="line">sum(rbinom(<span class="number">100</span>, <span class="number">5</span>, <span class="number">0.5</span>) == <span class="number">2</span>) / <span class="number">100</span>  <span class="comment"># 0.28</span></span><br><span class="line">sum(rbinom(<span class="number">1000</span>, <span class="number">5</span>, <span class="number">0.5</span>) == <span class="number">2</span>) / <span class="number">1000</span>   <span class="comment"># 0.294</span></span><br><span class="line">sum(rbinom(<span class="number">10000</span>, <span class="number">5</span>, <span class="number">0.5</span>) == <span class="number">2</span>) / <span class="number">10000</span>  <span class="comment"># 0.3139</span></span><br></pre></td></tr></tbody></table></figure>

<p>可以看到，随着随机次数的增加，成功2次的频率越来越接近理论值。</p>
<h2 id="正态分布"><a href="#正态分布" class="headerlink" title="正态分布"></a>正态分布</h2><p>正态分布是一个连续随机变量。</p>
<h3 id="dnorm"><a href="#dnorm" class="headerlink" title="dnorm"></a>dnorm</h3><p>dnorm(x) 计算 x 的对应概率密度函数值。这个函数用处不大。因为连续随机变量在某一点的概率为 0。</p>
<p>这个函数的唯一用处，大概是方便大家画出概率密度函数图。</p>
<h3 id="pnorm"><a href="#pnorm" class="headerlink" title="pnorm"></a>pnorm</h3><p><code>pnorm(5)</code> 实际上就是  P(X &lt;= 5)，计算了 X 小于等于5的概率。</p>
<p>所以，<code>pnorm(0)</code> 的结果是0.5，标准正态分布的一半嘛。</p>
<p>如果想计算期望等于1，标准差等于2的正太分布在 -3 &lt; x &lt;= 0 的概率呢？</p>
<figure class="highlight r"><figcaption><span>R代码</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnorm(<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>) - pnorm(-<span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>结果：0.2857874</p>
<h3 id="qnorm"><a href="#qnorm" class="headerlink" title="qnorm"></a>qnorm</h3><p><code>qnorm</code> 是 <code>pnorm</code> 的逆函数。<br>因为 pnorm(0)等于0.5，所以 qnorm(0.5)肯定等于0，不信你试试 <span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f60f.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f60f.png?v8">😏</span></p>
<h3 id="rnorm"><a href="#rnorm" class="headerlink" title="rnorm"></a>rnorm</h3><p><code>rnorm</code> 生成一组符合正态分布的随机数。</p>
<p>我们可以生成1000个数据，然后画图看看效果。</p>
<figure class="highlight r"><figcaption><span>R代码</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">n1000 &lt;- rnorm(<span class="number">1000</span>, mean = <span class="number">70</span>, sd = <span class="number">5</span>)</span><br><span class="line">hist(n1000, breaks = <span class="number">20</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>确实很符合正态分布。</p>
<img src="/blog/2020/01/13/r-dist-func/hist.png" class="" title="直方图-例子">

<p><code>rnorm</code> 是个好伙伴，在 simulation study 时用得非常多。</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script></div></article></div></main><footer><div class="paginator"><a class="next" href="/blog/2019/05/06/2019-05-07-userGrow-3/">next</a></div><div class="copyright"><p>&copy; 2020 <a href="http://yoursite.com">Yu Qin</a><br>Powered by <a href="https://hexo.io/" rel="noreferrer" target="_blank">Hexo</a></p></div></footer></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/barba.js/1.0.0/barba.min.js"></script><script>document.addEventListener('DOMContentLoaded', function() {
    Barba.Pjax.start()
})</script><!-- hexo-inject:begin --><!-- hexo-inject:end --></body></html>